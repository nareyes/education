{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "synlakehousedev"
		},
		"syn-dev-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'syn-dev-WorkspaceDefaultSqlServer'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=tcp:syn-dev.sql.azuresynapse.net,1433;Initial Catalog=@{linkedService().DBName}"
		},
		"synlakehousedev-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'synlakehousedev-WorkspaceDefaultSqlServer'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=tcp:synlakehousedev.sql.azuresynapse.net,1433;Initial Catalog=@{linkedService().DBName}"
		},
		"synlakehousedev-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://synlakehousedev.dfs.core.windows.net"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/syn-dev-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('syn-dev-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synlakehousedev-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('synlakehousedev-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synlakehousedev-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('synlakehousedev-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/calendar')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "discovery"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'calendar.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIRSTROW = 2\n    ) \n    WITH(\n        DateKey         INT         1\n        ,Date           DATE        2\n        ,Year           SMALLINT    3\n        ,Month          TINYINT     4\n        ,Day            TINYINT     5\n        ,DayName        VARCHAR(10) 6\n        ,DayOfYear      SMALLINT    7\n        ,WeekOfMonth    TINYINT     8\n        ,WeekOfYear     TINYINT     9\n        ,MonthName      VARCHAR(10) 10\n        ,YearMonth      INT         11\n        ,YearWeek       INT         12\n    ) AS Calendar",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/column_subset')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Select Subset of Columns (CSV w/ Headers)\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) \n    WITH(\n        Borough VARCHAR(15)  \n        ,Zone    VARCHAR(50) \n    ) AS TaxiZone\n\n\n-- Select Subset of Columns (CSV w/o Headers)\n-- Specify Column Ordinal Position in WITH Clause\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone_without_header.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0'\n    )\n    WITH(\n        Borough VARCHAR(15)  2\n        ,Zone   VARCHAR(50)  3\n    ) AS TaxiZone\n\n\n-- Renaming Columns\n-- Specify Column Ordinal Position in WITH Clause\n-- Synapse Ignores Header Column (Explicit: Use FIRSTROW Instead)\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        -- HEADER_ROW = TRUE\n        FIRSTROW = 2\n    ) \n    WITH(\n        LocationID      SMALLINT    \n        ,Borough        VARCHAR(15) \n        ,Zone           VARCHAR(50) \n        ,ServiceZone    VARCHAR(15) 4\n    ) AS TaxiZone\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        -- HEADER_ROW = TRUE\n        FIRSTROW = 2\n    ) \n    WITH(\n        location_id     SMALLINT    1\n        ,borough        VARCHAR(15) 2\n        ,zone           VARCHAR(50) 3   \n        ,service_zone   VARCHAR(15) 4\n    ) AS TaxiZone",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/cost_control')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "admin"
				},
				"content": {
					"query": "-- Data Processed\nSELECT * FROM sys.dm_external_data_processed;\n\n-- Current Cost Control Settings\nSELECT * FROM sys.configurations\nWHERE Name LIKE 'Data Processed%';\n\n-- Set Cost Control Limits\nsp_set_data_processed_limit\n    @type = N'monthly',\n    @limit_tb = 2;\n\nsp_set_data_processed_limit\n    @type = N'weekly',\n    @limit_tb = 1;\n\nsp_set_data_processed_limit\n    @type = N'daily',\n    @limit_tb = 1;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/debug_error')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Generate Error\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        -- HEADER_ROW = TRUE\n        FIRSTROW = 2\n    ) \n    WITH(\n        LocationID      SMALLINT    \n        ,Borough        VARCHAR(15) \n        ,Zone           VARCHAR(5) -- Incorrect Data Size\n        ,ServiceZone    VARCHAR(15)\n    ) AS TaxiZone\n\n\n-- Update Parser Version (Returns Explicit Error)\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '1.0', -- Changed From 2.0\n        -- HEADER_ROW = TRUE\n        FIRSTROW = 2\n    ) \n    WITH(\n        LocationID      SMALLINT    \n        ,Borough        VARCHAR(15) \n        ,Zone           VARCHAR(5) -- Incorrect Data Size\n        ,ServiceZone    VARCHAR(15)\n    ) AS TaxiZone",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/external_data_source')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Create External Data Source\n-- Navigate: Data > Database > External Resources\n-- Using HTTPS or ABFSS Protocol\nCREATE EXTERNAL DATA SOURCE NYC_Taxi_File_Drop\nWITH(\n    LOCATION = 'https://synlakehousedev.dfs.core.windows.net/file-drop/'\n)\n\nCREATE EXTERNAL DATA SOURCE NYC_Taxi_File_Drop_HTTPS\nWITH(\n    LOCATION = 'https://synlakehousedev.dfs.core.windows.net/file-drop/'\n)\n\nCREATE EXTERNAL DATA SOURCE NYC_Taxi_File_Drop_ABFSS\nWITH(\n    LOCATION = 'abfss://file-drop@synlakehousedev.dfs.core.windows.net/'\n)\n\n\n/*\nBenefits: Cleans queries and makes it easier for developers to query data lake.\nAbility to create reusable sources that point to different zones in the lakehouse.\n*/\nCREATE EXTERNAL DATA SOURCE NYC_Taxi_Raw\nWITH(\n    LOCATION = 'https://synlakehousedev.dfs.core.windows.net/nyc-taxi/raw'\n)\n\nCREATE EXTERNAL DATA SOURCE NYC_Taxi_Processed\nWITH(\n    LOCATION = 'https://synlakehousedev.dfs.core.windows.net/nyc-taxi/raw'\n)\n\nCREATE EXTERNAL DATA SOURCE NYC_Taxi_Curated\nWITH(\n    LOCATION = 'https://synlakehousedev.dfs.core.windows.net/nyc-taxi/raw'\n)\n\n\n-- Examine Data Sources\nSELECT \n    name \n    ,location\nFROM sys.external_data_sources;\n\n\n-- Drop Data Source\nDROP EXTERNAL DATA SOURCE NYC_Taxi_File_Drop_HTTPS\nGO\n\n\n-- Drop Data Source (IF EXISTS)\nIF EXISTS(\n    SELECT name FROM sys.external_data_sources WHERE name = 'NYC_Taxi_File_Drop_ABFSS'\n)\nBEGIN\n    DROP EXTERNAL DATA SOURCE NYC_Taxi_File_Drop_ABFSS\nEND\n\n\n-- Query Using External Data Source\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'taxi_zone.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        -- HEADER_ROW = TRUE\n        FIRSTROW = 2\n    ) \n    WITH(\n        LocationID      SMALLINT    \n        ,Borough        VARCHAR(15) \n        ,Zone           VARCHAR(50) \n        ,ServiceZone    VARCHAR(15) 4\n    ) AS TaxiZone",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/json_value_function')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_json"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query JSON Values\nSELECT\n    JSON_VALUE (jsonDoc, '$.payment_type') AS PaymentType\n    ,JSON_VALUE (jsonDoc, '$.payment_type_desc') AS PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\n\n-- Query JSON Values w/ Data Type\nSELECT\n    CAST (JSON_VALUE (jsonDoc, '$.payment_type') AS SMALLINT) AS PaymentType\n    ,CAST (JSON_VALUE (jsonDoc, '$.payment_type_desc') AS VARCHAR(15)) AS PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/kill_session')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "admin"
				},
				"content": {
					"query": "-- Query Session ID\nSELECT DB_NAME(database_id), 'kill '+ CAST(session_id AS VARCHAR(10)), *\n    FROM sys.dm_exec_sessions\n    WHERE DB_NAME(database_id) NOT IN ('master')\n    ORDER BY 1;\n\n\n-- Kill Session ID\nKILL <session_id>;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/openjson_function')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_json"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query JSON Values w/ OPENJSON\n-- OPENJSON = More Efficient, More Functionality\nSELECT\n    PaymentType\n    ,PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\nCROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n    WITH(\n        PaymentType             SMALLINT    '$.payment_type'\n        ,PaymentTypeDescription VARCHAR(15) '$.payment_type_desc'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/openrowset_function')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "-- OPENROWSET\n-- Use HTTPS or ABFSS Protocol\n\n-- HTTPS\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',', -- Default = ,\n        ROWTERMINATOR = '\\n' -- Default = \\n\n    ) AS TaxiZone\n\n\n-- ABFSS\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://file-drop@synlakehousedev.dfs.core.windows.net/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) AS TaxiZone",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/payment_type')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "discovery"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Basic Query\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\n\n-- Query JSON Values\nSELECT\n    JSON_VALUE (jsonDoc, '$.payment_type') AS PaymentType\n    ,JSON_VALUE (jsonDoc, '$.payment_type_desc') AS PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\n\n-- Query JSON Values w/ Data Type\nSELECT\n    CAST (JSON_VALUE (jsonDoc, '$.payment_type') AS SMALLINT) AS PaymentType\n    ,CAST (JSON_VALUE (jsonDoc, '$.payment_type_desc') AS VARCHAR(15)) AS PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\n\nUSE NYC_Taxi_Serverless\nGO\n\n\n-- Query JSON Values w/ OPENJSON\n-- OPENJSON = More Efficient, More Functionality\nSELECT\n    PaymentType\n    ,PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\nCROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n    WITH(\n        PaymentType             SMALLINT    '$.payment_type'\n        ,PaymentTypeDescription VARCHAR(15) '$.payment_type_desc'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_calendar_csv')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query Calendar CSV File\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'calendar.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS Calendar\n\n\n-- Query Calendar Data Types\nEXEC sp_describe_first_result_set N'\n    SELECT\n        TOP 100 *\n    FROM\n        OPENROWSET(\n            BULK ''calendar.csv'',\n            DATA_SOURCE = ''NYC_Taxi_Raw'',\n            FORMAT = ''CSV'',\n            PARSER_VERSION = ''2.0'',\n            HEADER_ROW = TRUE\n        ) AS Calendar\n'\n\n\n-- Query Calendar CSV File w/ Optimizaed Data Types and Size\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'calendar.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIRSTROW = 2\n    ) \n    WITH(\n        DateKey         INT         1\n        ,Date           DATE        2\n        ,Year           SMALLINT    3\n        ,Month          TINYINT     4\n        ,Day            TINYINT     5\n        ,DayName        VARCHAR(10) 6\n        ,DayOfYear      SMALLINT    7\n        ,WeekOfMonth    TINYINT     8\n        ,WeekOfYear     TINYINT     9\n        ,MonthName      VARCHAR(10) 10\n        ,YearMonth      INT         11\n        ,YearWeek       INT         12\n    ) AS Calendar",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_json_array')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_json"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query JSON Array w/ JSON_VALUES\nSELECT\n    JSON_VALUE (jsonDoc, '$.payment_type') AS PaymentType\n    ,JSON_VALUE (jsonDoc, '$.payment_type_desc[0].value') AS PaymentTypeDescription -- Use Index Position of Array\nFROM\n    OPENROWSET(\n        BULK 'payment_type_array.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\n\n-- Query JSON Array w/ OPENJSON\nSELECT\n    PaymentType\n    ,PaymentTypeDescription\nFROM\n    OPENROWSET(\n        BULK 'payment_type_array.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0a'\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS PaymentType\n\nCROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n    WITH(\n        PaymentType         SMALLINT        '$.payment_type'\n        ,payment_type_desc  NVARCHAR(MAX)   AS JSON\n    )\n\nCROSS APPLY OPENJSON(payment_type_desc)\n    WITH(\n        PaymentSubType          SMALLINT    '$.sub_type'\n        ,PaymentTypeDescription VARCHAR(20) '$.value'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_multiline_json')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_json"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query Multi-Line JSON Values w/ OPENJSON\n-- OPENJSON = More Efficient, More Functionality\nSELECT\n    RateCodeID\n    ,RateCodeDescription\nFROM\n    OPENROWSET(\n        BULK 'rate_code_multi_line.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b' -- Vertical Tab\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS RateCode\n\nCROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n    WITH(\n        RateCodeID              TINYINT     '$.rate_code_id'\n        ,RateCodeDescription    VARCHAR(20) '$.rate_code'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_standard_json')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_json"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query Standard JSON Values w/ OPENJSON\n-- OPENJSON = More Efficient, More Functionality\nSELECT\n    RateCodeID\n    ,RateCodeDescription\nFROM\n    OPENROWSET(\n        BULK 'rate_code.json',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV', -- Even for JSON\n        PARSER_VERSION = '1.0',\n        FIELDTERMINATOR = '0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b' -- Vertical Tab\n    ) \n    WITH(\n        jsonDoc NVARCHAR(MAX)\n    ) AS RateCode\n\nCROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n    WITH(\n        RateCodeID              TINYINT     '$.rate_code_id'\n        ,RateCodeDescription    VARCHAR(20) '$.rate_code'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_trip_type_tsv')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query Trip Type TSV File\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'trip_type.tsv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        FIELDTERMINATOR = '\\t',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n) AS TripType\n\n\n-- Query Trip Type Data Types\nEXEC sp_describe_first_result_set N'\n    SELECT\n        TOP 100 *\n    FROM\n        OPENROWSET(\n            BULK ''trip_type.tsv'',\n            DATA_SOURCE = ''NYC_Taxi_Raw'',\n            FORMAT = ''CSV'',\n            FIELDTERMINATOR = ''\\t'',\n            PARSER_VERSION = ''2.0'',\n            HEADER_ROW = TRUE\n    ) AS TripType\n'\n\n\n-- Query Trip Type TSV File w/ Optimizaed Data Types and Size\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'trip_type.tsv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        FIELDTERMINATOR = '\\t',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH(\n        TripType                SMALLINT    1\n        ,TripTypeDescription    VARCHAR(25) 2\n    ) AS TripType",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/quoted_escaped_columns')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Query CSV File w/ Additional Comma\n-- \", Inc\" Ignored\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'vendor_unquoted.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n) AS Vendor\n\n\n-- Escape Character\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'vendor_escaped.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        ESCAPECHAR = '\\'\n) AS Vendor\n\n\n-- Quote Character\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'vendor.csv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDQUOTE = '\"' -- Optional. Default is \"\"\n) AS Vendor",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/specify_collation')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "-- Examine Database Collation\nSELECT\n    name\n    ,collation_name\nFROM sys.databases;\n\n\n-- Apply Collation to a Query\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) \n    WITH(\n        LocationID      SMALLINT\n        ,Borough        VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n        ,Zone           VARCHAR(50) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n        ,service_zone   VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n    ) AS TaxiZone\n\n\n-- Apply Collation to a Database\n-- Not Applicable to Master Database\nUSE NYC_Taxi_Serverless;\nALTER DATABASE NYC_Taxi_Serverless COLLATE Latin1_General_100_CI_AI_SC_UTF8;\n\n\n-- Confirm Collation Change\nSELECT\n    name\n    ,collation_name\nFROM sys.databases;\n\n\n-- Query Will Now Run w/o Collation Warnings\n-- Must Be Using Appropriate Database\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) \n    WITH(\n        LocationID      SMALLINT\n        ,Borough        VARCHAR(15)\n        ,Zone           VARCHAR(50)\n        ,service_zone   VARCHAR(15)\n    ) AS TaxiZone",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/specify_data_types')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_csv"
				},
				"content": {
					"query": "-- Examine Data Types\n-- Escape Single Quotes in Query\nEXEC sp_describe_first_result_set N'\n    SELECT\n        TOP 100 *\n    FROM\n        OPENROWSET(\n            BULK ''https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv'',\n            FORMAT = ''CSV'',\n            PARSER_VERSION = ''2.0'',\n            HEADER_ROW = TRUE\n        ) AS TaxiZone\n'\n\n\n-- Determine Actual Max Length per Column\nSELECT\n    MAX(LEN(LocationID)) AS Len_LocationID\n    ,MAX(LEN(Borough)) AS Len_Borough\n    ,MAX(LEN(Zone)) AS Len_Zone\n    ,MAX(LEN(service_zone)) AS Len_Service_Zone\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TaxiZone\n\n\n/*\n- Adjusting data types and sizes has cost and permofrmance implications.\n- Synapse is generous with its data type and size assignment.\n- It is a best practice to adjust sizes when running queries in Serverless to minimize cost.\n*/\n\n\n-- Use WITH to Provide Explicit Data Types\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) \n    WITH(\n        LocationID      SMALLINT\n        ,Borough        VARCHAR(15)\n        ,Zone           VARCHAR(50)\n        ,service_zone   VARCHAR(15)\n    ) AS TaxiZone\n\n\n-- Confirm Explicit Data Types\nEXEC sp_describe_first_result_set N'\n    SELECT\n        TOP 100 *\n    FROM\n        OPENROWSET(\n            BULK ''https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv'',\n            FORMAT = ''CSV'',\n            PARSER_VERSION = ''2.0'',\n            HEADER_ROW = TRUE\n        )\n        WITH(\n            LocationID      SMALLINT\n            ,Borough        VARCHAR(15)\n            ,Zone           VARCHAR(50)\n            ,service_zone   VARCHAR(15)\n        ) AS TaxiZone\n'",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/taxi_zone')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "discovery"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://synlakehousedev.dfs.core.windows.net/file-drop/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        -- HEADER_ROW = TRUE\n        FIRSTROW = 2\n    ) \n    WITH(\n        LocationID      SMALLINT    \n        ,Borough        VARCHAR(15) \n        ,Zone           VARCHAR(50) \n        ,ServiceZone    VARCHAR(15) 4\n    ) AS TaxiZone",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/trip_type')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "discovery"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'trip_type.tsv',\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        FIELDTERMINATOR = '\\t',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH(\n        TripType                SMALLINT    1\n        ,TripTypeDescription    VARCHAR(25) 2\n    ) AS TripType",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/NYC_Taxi_Dedicated')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"collation": "SQL_Latin1_General_CP1_CI_AS",
				"maxSizeBytes": 263882790666240,
				"annotations": []
			},
			"dependsOn": [],
			"location": "centralus"
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_folders')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_folders"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Select All Files From Folder w/ Single File\nSELECT\n    TOP 100\n    TripData.filename() AS file_name\n    ,TripData.*\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=2020/month=01/', -- *, *.csv\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\n\n\n-- Select All Files From Folder w/ Sub-Folders\nSELECT\n    TOP 100\n    TripData.filename() AS file_name\n    ,TripData.*\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=2020/**', -- ** All Underlying Sub-Folders\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\n\n\nSELECT\n    TOP 100\n    TripData.filename() AS file_name\n    ,TripData.*\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=*/month=*/*.csv', -- ** All Folders and Sub-Folders\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\n\n\n-- Select All Files From Folder and Specified Sub-Folders\nSELECT\n    TOP 100\n    TripData.filename() AS file_name\n    ,TripData.*\nFROM\n    OPENROWSET(\n        BULK    (\n            'trip_data_green_csv/year=2020/month=01/*.csv',\n            'trip_data_green_csv/year=2020/month=03/*.csv'\n        ),\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/query_file_metadata')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "query_folders"
				},
				"content": {
					"query": "USE NYC_Taxi_Serverless\nGO\n\n-- FILENAME Function\nSELECT\n    TripData.filename() AS file_name\n    ,COUNT(1) AS record_count\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=*/month=*/*.csv', -- ** All Folders and Sub-Folders\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\nGROUP BY TripData.filename()\nORDER BY file_name ASC;\n\n\n-- FILENAME Function w/ WHERE Clause\nSELECT\n    TripData.filename() AS file_name\n    ,COUNT(1) AS record_count\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=*/month=*/*.csv', -- ** All Folders and Sub-Folders\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\nWHERE TripData.filename() IN ('green_tripdata_2020-01.csv', 'green_tripdata_2021-01.csv') -- Alternate to Specifying in BULK\nGROUP BY TripData.filename()\nORDER BY file_name ASC;\n\n\n-- FILEPATH Function\nSELECT\n    TripData.filepath() AS file_path\n    -- Using Ordinal Wildcard Position\n    ,TripData.filepath(1) AS year\n    ,TripData.filepath(2) AS month\n    ,TripData.filepath(3) AS file_name\n    ,COUNT(1) AS record_count\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=*/month=*/*.csv', -- ** All Folders and Sub-Folders\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\nGROUP BY TripData.filepath(), TripData.filepath(1), TripData.filepath(2), TripData.filepath(3)\nORDER BY file_path ASC;\n\n\n-- FILEPATH Function w/ WHERE Clause\nSELECT\n    TripData.filepath() AS file_path\n    -- Using Ordinal Wildcard Position\n    ,TripData.filepath(1) AS year\n    ,TripData.filepath(2) AS month\n    ,TripData.filepath(3) AS file_name\n    ,COUNT(1) AS record_count\nFROM\n    OPENROWSET(\n        BULK 'trip_data_green_csv/year=*/month=*/*.csv', -- ** Best Practice be Explicit\n        DATA_SOURCE = 'NYC_Taxi_Raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS TripData\nWHERE 1=1\n    AND TripData.filepath(1) = '2020'\n    AND TripData.filepath(2) IN ('06', '07', '08')\nGROUP BY TripData.filepath(), TripData.filepath(1), TripData.filepath(2), TripData.filepath(3)\nORDER BY file_path ASC;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "NYC_Taxi_Serverless",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		}
	]
}