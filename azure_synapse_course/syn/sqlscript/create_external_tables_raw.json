{
	"name": "create_external_tables_raw",
	"properties": {
		"folder": {
			"name": "dw_serverless"
		},
		"content": {
			"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Calendar\nIF OBJECT_ID ('Raw.Calendar') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.Calendar\n    GO\n\nCREATE EXTERNAL TABLE Raw.Calendar (\n    DateKey         INT         \n    ,Date           DATE        \n    ,Year           SMALLINT    \n    ,Month          TINYINT     \n    ,Day            TINYINT     \n    ,DayName        VARCHAR(10) \n    ,DayOfYear      SMALLINT    \n    ,WeekOfMonth    TINYINT     \n    ,WeekOfYear     TINYINT     \n    ,MonthName      VARCHAR(10) \n    ,YearMonth      INT         \n    ,YearWeek       INT         \n)\n\n    WITH (\n        LOCATION = 'calendar.csv'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = CSV_File_Format\n        ,REJECT_VALUE = 10\n        ,REJECTED_ROW_LOCATION = 'rejections/calendar'\n    );\n\nSELECT * FROM Raw.Calendar;\n\n\n-- Taxi Zone\nIF OBJECT_ID ('Raw.TaxiZone') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.TaxiZone\n    GO\n\nCREATE EXTERNAL TABLE Raw.TaxiZone (\n    LocationID      SMALLINT\n    ,Borough        VARCHAR(15)\n    ,Zone           VARCHAR(50)\n    ,ServiceZone    VARCHAR(15)\n)\n\n    WITH (\n        LOCATION = 'taxi_zone.csv'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = CSV_File_Format\n        ,REJECT_VALUE = 10\n        ,REJECTED_ROW_LOCATION = 'rejections/taxi_zone'\n    );\n\nSELECT * FROM Raw.TaxiZone;\n\n\n-- Trip Type\nIF OBJECT_ID ('Raw.TripType') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.TripType\n    GO\n\nCREATE EXTERNAL TABLE Raw.TripType (\n    TripType                SMALLINT\n    ,TripTypeDescription    VARCHAR(25)\n)\n\n    WITH (\n        LOCATION = 'trip_type.tsv'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = TSV_File_Format\n        ,REJECT_VALUE = 10\n        ,REJECTED_ROW_LOCATION = 'rejections/trip_type'\n    );\n\nSELECT * FROM Raw.TripType;\n\n\n-- Vendor\nIF OBJECT_ID ('Raw.Vendor') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.Vendor\n    GO\n\nCREATE EXTERNAL TABLE Raw.Vendor (\n    VendorID    SMALLINT\n    ,VendorName VARCHAR(35)\n)\n\n    WITH (\n        LOCATION = 'vendor.csv'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = CSV_File_Format\n        ,REJECT_VALUE = 10\n        ,REJECTED_ROW_LOCATION = 'rejections/trip_type'\n    );\n\nSELECT * FROM Raw.Vendor;\n\n\n-- Trip Data CSV\n-- External Tables Do Not Support Partition Pruning\nIF OBJECT_ID ('Raw.TripCSV') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.TripCSV\n    GO\n\nCREATE EXTERNAL TABLE Raw.TripCSV (\n    VendorID\t            TINYINT\n    ,PickupDateTime\t        DATETIME2(0)\n    ,DropoffDateTime\t    DATETIME2(0)\n    ,StoreAndFwdFlag\t    VARCHAR(10)\n    ,RateCodeID\t            SMALLINT\n    ,PULocationID\t        SMALLINT\n    ,DOLocationID\t        SMALLINT\n    ,PassengerCount\t        TINYINT\n    ,TripDistance\t        FLOAT\n    ,FareAmount\t            FLOAT\n    ,Extra\t                FLOAT\n    ,MTATax\t                FLOAT\n    ,TipAmount\t            FLOAT\n    ,TollsAmount\t        FLOAT\n    ,EhailFee\t            VARCHAR(50)\n    ,ImprovementSurcharge   FLOAT\n    ,TotalAmount\t        FLOAT\n    ,PaymentType\t        BIGINT\n    ,TripType               BIGINT\n    ,CongestionSurcharge    FLOAT\n)\n\n    WITH (\n        LOCATION = 'trip_data_green_csv/**'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = CSV_File_Format\n        ,REJECT_VALUE = 10\n        ,REJECTED_ROW_LOCATION = 'rejections/trip_csv'\n    );\n\nSELECT TOP 100 * FROM Raw.TripCSV;\n\n\n-- Trip Data Parquet (Column Names Need to Match Source)\n-- External Tables Do Not Support Partition Pruning\nIF OBJECT_ID ('Raw.TripParquet') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.TripParquet\n    GO\n\nCREATE EXTERNAL TABLE Raw.TripParquet (\n    VendorID\t            TINYINT\n    ,lpep_pickup_datetime\tDATETIME2(0) 2\n    ,lpep_dropoff_datetime\tDATETIME2(0)\n    ,store_and_fwd_flag\t    VARCHAR(10)\n    ,RatecodeID\t            SMALLINT\n    ,PULocationID\t        SMALLINT\n    ,DOLocationID\t        SMALLINT\n    ,passenger_count\t    TINYINT\n    ,trip_distance\t        FLOAT\n    ,fare_amount\t        FLOAT\n    ,extra\t                FLOAT\n    ,mta_tax\t            FLOAT\n    ,tip_amount\t            FLOAT\n    ,tolls_amount\t        FLOAT\n    ,ehail_fee\t            VARCHAR(50)\n    ,improvement_surcharge  FLOAT\n    ,total_amount\t        FLOAT\n    ,payment_type\t        BIGINT\n    ,trip_type              BIGINT\n    ,congestion_surcharge   FLOAT\n)\n\n    WITH (\n        LOCATION = 'trip_data_green_parquet/**'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = Parquet_File_Format\n        ,REJECT_VALUE = 10\n        ,REJECTED_ROW_LOCATION = 'rejections/trip_parquet'\n    );\n\nSELECT TOP 100 * FROM Raw.TripParquet;\n\n\n-- Trip Data Delta (Column Names Need to Match Source)\n-- External Tables Do Not Support Partition Pruning\nIF OBJECT_ID ('Raw.TripDelta') IS NOT NULL\n    DROP EXTERNAL TABLE Raw.TripDelta\n    GO\n\nCREATE EXTERNAL TABLE Raw.TripDelta (\n    VendorID\t            TINYINT\n    ,lpep_pickup_datetime\tDATETIME2(0)\n    ,lpep_dropoff_datetime\tDATETIME2(0)\n    ,store_and_fwd_flag\t    VARCHAR(10)\n    ,RatecodeID\t            SMALLINT\n    ,PULocationID\t        SMALLINT\n    ,DOLocationID\t        SMALLINT\n    ,passenger_count\t    TINYINT\n    ,trip_distance\t        FLOAT\n    ,fare_amount\t        FLOAT\n    ,extra\t                FLOAT\n    ,mta_tax\t            FLOAT\n    ,tip_amount\t            FLOAT\n    ,tolls_amount\t        FLOAT\n    ,ehail_fee\t            VARCHAR(50)\n    ,improvement_surcharge  FLOAT\n    ,total_amount\t        FLOAT\n    ,payment_type\t        BIGINT\n    ,trip_type              BIGINT\n    ,congestion_surcharge   FLOAT\n)\n\n    WITH (\n        LOCATION = 'trip_data_green_delta'\n        ,DATA_SOURCE = NYC_Taxi_Raw\n        ,FILE_FORMAT = Delta_File_Format\n        -- Reject Value Not Supported\n        -- ,REJECT_VALUE = 10\n        -- ,REJECTED_ROW_LOCATION = 'rejections/trip_delta'\n    );\n\nSELECT TOP 100 * FROM Raw.TripDelta;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "NYC_Taxi_Serverless",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}