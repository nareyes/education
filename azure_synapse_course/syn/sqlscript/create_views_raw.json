{
	"name": "create_views_raw",
	"properties": {
		"folder": {
			"name": "dw_serverless"
		},
		"content": {
			"query": "USE NYC_Taxi_Serverless\nGO\n\n-- Rate Code (JSON Source)\nDROP VIEW IF EXISTS Raw.View_RateCode\nGO\n\nCREATE VIEW Raw.View_RateCode\nAS\n    SELECT\n        RateCodeID\n        ,RateCodeDescription\n    FROM\n        OPENROWSET (\n            BULK 'rate_code.json',\n            DATA_SOURCE = 'NYC_Taxi_Raw',\n            FORMAT = 'CSV', -- Even for JSON\n            PARSER_VERSION = '1.0',\n            FIELDTERMINATOR = '0x0b',\n            FIELDQUOTE = '0x0b',\n            ROWTERMINATOR = '0x0b' -- Vertical Tab\n        ) \n        WITH (\n            jsonDoc NVARCHAR(MAX)\n        ) AS RateCode\n\n    CROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n        WITH (\n            RateCodeID              TINYINT     '$.rate_code_id'\n            ,RateCodeDescription    VARCHAR(20) '$.rate_code'\n        );\nGO\n\nSELECT * FROM Raw.View_RateCode;\nGO\n\n\n-- Payment Type\nDROP VIEW IF EXISTS Raw.View_PaymentType\nGO\n\nCREATE VIEW Raw.View_PaymentType\nAS\n    SELECT\n        PaymentType\n        ,PaymentTypeDescription\n    FROM\n        OPENROWSET (\n            BULK 'payment_type.json',\n            DATA_SOURCE = 'NYC_Taxi_Raw',\n            FORMAT = 'CSV', -- Even for JSON\n            PARSER_VERSION = '1.0',\n            FIELDTERMINATOR = '0x0b',\n            FIELDQUOTE = '0x0b',\n            ROWTERMINATOR = '0x0a'\n        ) \n        WITH (\n            jsonDoc NVARCHAR(MAX)\n        ) AS PaymentType\n\n    CROSS APPLY OPENJSON(jsonDoc) -- Return Key Value Pairs\n        WITH (\n            PaymentType             SMALLINT    '$.payment_type'\n            ,PaymentTypeDescription VARCHAR(15) '$.payment_type_desc'\n        )\nGO\n\nSELECT * FROM Raw.View_PaymentType;\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "NYC_Taxi_Serverless",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}