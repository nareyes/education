USE WAREHOUSE COMPUTE_WH;


-- QUERY SAMPLE
SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
SAMPLE SYSTEM (1) SEED(23);

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
SAMPLE SYSTEM (10) SEED(23);



-- CREATE VIEW WITH SAMPLE
CREATE OR REPLACE VIEW DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE AS (
    SELECT * 
    FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
    SAMPLE ROW (1) SEED(27)
); 


-- CREATE VIEW WITH LARGER SAMPLE FOR COMPARISON
CREATE OR REPLACE VIEW DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE_LARGE AS (
    SELECT * 
    FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
    SAMPLE ROW (10) SEED(27)
); 


-- INSPECT DATA
SELECT * FROM DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE;
SELECT * FROM DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE_LARGE;


-- INSPECT COMPARISONS
//SMALL SAMPLE (SINGLE FAMILY 3.2347, APARTMENT 3.2293, CONDO 3.2479, NULL 0.2987)
SELECT
    CA_LOCATION_TYPE,
    COUNT(*) / 3254250 * 100
FROM DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE
GROUP BY CA_LOCATION_TYPE; 

// LARGE SAMPLE (SINGLE FAMILY 3.2291, APARTMENT 3.2266, CONDO 3.2300, NULL 0.2996)
SELECT 
    CA_LOCATION_TYPE,
    COUNT(*) / 32542500 * 100
FROM DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE_LARGE
GROUP BY CA_LOCATION_TYPE;